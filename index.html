<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tailor Your Updates â€” Preferences</title>

<style>
/* ---------- Variables & General Styles ---------- */
:root {
  --max-width: 760px;
  --accent: #0A64A4;
  --muted: #6b7280;
  --bg: #f7f8fb;
  --card: #ffffff;
  --radius: 10px;
  --transition: 220ms cubic-bezier(.2,.9,.2,1);
  --form-height: auto;
}

html, body {
  height: 100%;
}
body {
  margin: 0;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(180deg, #f4f6fa, var(--bg));
  color: #111827;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  padding: 28px;
  display: flex;
  align-items: flex-start;
  justify-content: center;
}

.container {
  width: 100%;
  max-width: var(--max-width);
}

.card {
  background: var(--card);
  border-radius: var(--radius);
  padding: 22px;
  box-shadow: 0 8px 30px rgba(16,24,40,0.06);
  height: var(--form-height);
  transition: height 0.4s ease-in-out;
}

h1 {
  margin: 0 0 6px 0;
  font-size: 20px;
  letter-spacing: -0.2px;
}
p.lead {
  margin: 0 0 18px 0;
  color: var(--muted);
  font-size: 14px;
}

/* ---------- Progress Bar ---------- */
.progress-container {
  padding: 18px 0;
}
.progress-bar {
  width: 100%;
  height: 6px;
  background: #eef2f6;
  border-radius: 3px;
  overflow: hidden;
}
.progress-fill {
  height: 100%;
  background: var(--accent);
  transition: width 0.4s ease;
}

/* ---------- Multi-step form styles ---------- */
#step-container {
  position: relative;
  overflow: hidden;
  height: auto;
}

.step {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  padding-right: 22px;
  transition: transform 0.4s ease-in-out, opacity 0.4s ease-in-out;
  transform: translateX(100%);
  opacity: 0;
}

.step.active {
  position: relative;
  transform: translateX(0);
  opacity: 1;
}

.step.prev {
  transform: translateX(-100%);
}

.step.next {
  transform: translateX(100%);
}

.step.active.fade-in {
  transform: translateX(0);
  opacity: 1;
}
.step.fade-out {
  opacity: 0;
}

/* ---------- Question group ---------- */
.group {
  border-top: 1px solid #eef2f6;
  padding: 18px 0;
}
.group:first-of-type {
  border-top: 0;
  padding-top: 6px;
}
.q {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}
.q h2 {
  margin: 0;
  font-size: 15px;
}
.optional {
  color: var(--muted);
  font-size: 13px;
}

/* ---------- Checkbox grid ---------- */
.options {
  margin-top: 12px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
  gap: 10px;
}

/* Custom checkbox look */
.opt {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  border-radius: 8px;
  cursor: pointer;
  user-select: none;
  transition: transform var(--transition), box-shadow var(--transition), background var(--transition);
  border: 1px solid #eef2f6;
  background: #fff;
  box-shadow: 0 0 0 rgba(0,0,0,0);
}
.opt input {
  position: absolute;
  clip: rect(0 0 0 0);
  height: 1px;
  width: 1px;
  margin: -1px;
  padding: 0;
  border: 0;
  overflow: hidden;
}
.opt .label {
  font-size: 14px;
  color: #111827;
}
.opt .muted {
  font-size: 12px;
  color: var(--muted);
}

/* selected state */
.opt.selected {
  transform: translateY(-3px) scale(1.01);
  box-shadow: 0 6px 18px rgba(10,100,164,0.14);
  border-color: rgba(10,100,164,0.14);
  background: linear-gradient(180deg, rgba(10,100,164,0.03), #fff);
}

/* ---------- Conditional panels (expand/collapse) ---------- */
.panel {
  overflow: hidden;
  transition: max-height var(--transition), opacity var(--transition), transform var(--transition);
  max-height: 0;
  opacity: 0;
  transform: translateY(-6px);
}
.panel.open {
  max-height: 1000px;
  opacity: 1;
  transform: translateY(0);
}

/* ---------- Small controls ---------- */
.row {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  margin-top: 10px;
}
.small {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #e6eef8;
  background: #fff;
  font-size: 13px;
}

/* ---------- Footer / submit ---------- */
.actions {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  margin-top: 18px;
  gap: 12px;
}

.actions.full-width {
    justify-content: space-between;
}

.btn {
  padding: 10px 14px;
  border-radius: 8px;
  border: 0;
  background: var(--accent);
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: transform var(--transition);
}
.btn:active {
  transform: translateY(1px)
}
.btn.ghost {
  background: transparent;
  color: var(--accent);
  border: 1px solid rgba(10,100,164,0.12);
}

/* ---------- Thank you / confirmation ---------- */
.thanks {
  padding: 18px;
  border-radius: 8px;
  background: #f1fbff;
  border: 1px solid rgba(10,100,164,0.06);
  color: #05263b;
  margin-top: 12px;
  display: none;
}
.thanks.show {
  display: block;
}

/* ---------- Small responsive tweaks ---------- */
@media (max-width: 520px) {
  .options {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ---------- Micro interaction: focus visible ---------- */
.opt:focus-within {
  outline: 3px solid rgba(10,100,164,0.08);
}
</style>
</head>
<body>
<div class="container">
  <form id="prefsForm" class="card" method="POST" novalidate action="">
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" style="width: 0%;"></div>
      </div>
    </div>
    
    <h1 id="form-heading">Tailor your updates</h1>
    <p class="lead" id="form-subheading">Tick only what is relevant. Optional fields help us keep messages short and useful.</p>

    <div id="step-container">
      <section class="group step active" aria-labelledby="q1">
        <div class="q">
          <h2 id="q1">1. Which servers do you run or follow?</h2>
        </div>
        <div class="options" role="group" aria-label="Servers">
          <label class="opt" tabindex="0">
            <input type="checkbox" name="servers" value="HP ProLiant" data-target="#hp-panel" />
            <div><div class="label">HP ProLiant</div></div>
          </label>
          <label class="opt" tabindex="0">
            <input type="checkbox" name="servers" value="Dell PowerEdge" data-target="#dell-panel" />
            <div><div class="label">Dell PowerEdge</div></div>
          </label>
          <label class="opt" tabindex="0">
            <input type="checkbox" name="servers" value="IBM/Lenovo" data-target="#ibm-panel" />
            <div><div class="label">IBM/Lenovo</div></div>
          </label>
          <label class="opt" tabindex="0">
            <input type="checkbox" name="servers" value="Not interested" />
            <div><div class="label">Not interested in servers</div></div>
          </label>
        </div>
      </section>

      <section class="group step" aria-hidden="true">
        <div class="q">
          <h2 id="q1a">1a. (Optional) Current Models / Generations</h2>
          <div class="optional">This helps us send updates that fit your hardware.</div>
        </div>
        <div id="hp-panel" class="panel">
          <div class="muted" style="font-size:13px;margin-bottom:8px">HP ProLiant</div>
          <div class="row" role="group" aria-label="HP ProLiant generations">
            <label class="opt small"><input type="checkbox" name="hp_gens" value="Gen8" /><div><div class="label">Gen8</div></div></label>
            <label class="opt small"><input type="checkbox" name="hp_gens" value="Gen9" /><div><div class="label">Gen9</div></div></label>
            <label class="opt small"><input type="checkbox" name="hp_gens" value="Gen10" /><div><div class="label">Gen10</div></div></label>
            <label class="opt small"><input type="checkbox" name="hp_gens" value="Gen11" /><div><div class="label">Gen11</div></div></label>
            <label class="opt small"><input type="checkbox" name="hp_gens" value="Other / Not sure" /><div><div class="label">Other / Not sure</div></div></label>
          </div>
        </div>
        <div id="dell-panel" class="panel">
          <div class="muted" style="font-size:13px;margin:14px 0 8px 0">Dell PowerEdge</div>
          <div class="row" role="group" aria-label="Dell PowerEdge generations">
            <label class="opt small"><input type="checkbox" name="dell_gens" value="11th Gen" /><div><div class="label">11th</div></div></label>
            <label class="opt small"><input type="checkbox" name="dell_gens" value="12th Gen" /><div><div class="label">12th</div></div></label>
            <label class="opt small"><input type="checkbox" name="dell_gens" value="13th Gen" /><div><div class="label">13th</div></div></label>
            <label class="opt small"><input type="checkbox" name="dell_gens" value="14th Gen" /><div><div class="label">14th</div></div></label>
            <label class="opt small"><input type="checkbox" name="dell_gens" value="15th Gen" /><div><div class="label">15th</div></div></label>
            <label class="opt small"><input type="checkbox" name="dell_gens" value="Other / Not sure" /><div><div class="label">Other / Not sure</div></div></label>
          </div>
        </div>
        <div id="ibm-panel" class="panel">
          <div class="muted" style="font-size:13px;margin:14px 0 8px 0">IBM/Lenovo</div>
          <div class="row" role="group" aria-label="IBM/Lenovo generations">
            <label class="opt small"><input type="checkbox" name="ibm_gens" value="x3650 / x3550 etc." /><div><div class="label">x3650 / x3550 etc.</div></div></label>
            <label class="opt small"><input type="checkbox" name="ibm_gens" value="ThinkSystem (SR series)" /><div><div class="label">ThinkSystem (SR series)</div></div></label>
            <label class="opt small"><input type="checkbox" name="ibm_gens" value="Other / Not sure" /><div><div class="label">Other / Not sure</div></div></label>
          </div>
        </div>
      </section>

      <section class="group step" aria-hidden="true">
        <div class="q"><h2>2. What storage systems do you use or follow?</h2></div>
        <div class="options" role="group" aria-label="Storage" style="margin-top:10px">
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="SAN Arrays" /><div><div class="label">SAN Arrays</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="DAS" /><div><div class="label">DAS (Direct Attached)</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="HPE 3PAR" /><div><div class="label">HPE 3PAR</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="Dell Compellent" /><div><div class="label">Dell Compellent</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="Dell EqualLogic" /><div><div class="label">Dell EqualLogic</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="HPE MSA" /><div><div class="label">HPE MSA</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="Tape" /><div><div class="label">Tape</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="storage" value="Other" /><div><div class="label">Other</div></div></label>
        </div>
      </section>

      <section class="group step" aria-hidden="true">
        <div class="q"><h2>3. Updates on:</h2></div>
        <div class="options" role="group" aria-label="Networking" style="margin-top:10px">
          <label class="opt" tabindex="0"><input type="checkbox" name="networking" value="Switches" /><div><div class="label">Switches</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="networking" value="Routers" /><div><div class="label">Routers</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="networking" value="Firewalls" /><div><div class="label">Firewalls</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="networking" value="Network Cards" /><div><div class="label">Network Cards</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="networking" value="Fibre Channel" /><div><div class="label">Fibre Channel</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="networking" value="Other" /><div><div class="label">Other</div></div></label>
        </div>
      </section>

      <section class="group step" aria-hidden="true">
        <div class="q"><h2>4. Interested in:</h2></div>
        <div class="options" role="group" aria-label="Components" style="margin-top:10px">
          <label class="opt" tabindex="0"><input type="checkbox" name="components" value="Memory / RAM" /><div><div class="label">Memory / RAM</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="components" value="CPUs" /><div><div class="label">CPUs</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="components" value="Hard Drives" /><div><div class="label">Hard Drives</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="components" value="RAID Controllers" /><div><div class="label">RAID Controllers</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="components" value="Power Supplies" /><div><div class="label">Power Supplies</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="components" value="Rail Kits" /><div><div class="label">Rail Kits</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="components" value="Other" /><div><div class="label">Other</div></div></label>
        </div>
      </section>
      
      <section class="group step" aria-hidden="true">
        <div class="q"><h2>5. Would you like offers or updates on:</h2></div>
        <div class="options" role="group" aria-label="Systems & Devices" style="margin-top:10px">
          <label class="opt" tabindex="0"><input type="checkbox" name="systems" value="Workstations" /><div><div class="label">Workstations</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="systems" value="Desktops" /><div><div class="label">Desktops</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="systems" value="Laptops" /><div><div class="label">Laptops</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="systems" value="Graphics Cards" /><div><div class="label">Graphics Cards</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="systems" value="Other" /><div><div class="label">Other</div></div></label>
        </div>
      </section>

      <section class="group step" aria-hidden="true">
        <div class="q"><h2>6. How would you like information delivered?</h2></div>
        <div class="options" role="group" aria-label="Update types" style="margin-top:10px">
          <label class="opt" tabindex="0"><input type="checkbox" name="updates" value="New Products" /><div><div class="label">New Products</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="updates" value="Price Changes" /><div><div class="label">Price Changes</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="updates" value="Product Tests & Reviews" /><div><div class="label">Product Tests & Reviews</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="updates" value="Guides / How-tos" /><div><div class="label">Guides / How-tos</div></div></label>
          <label class="opt" tabindex="0"><input type="checkbox" name="updates" value="Configurations" /><div><div class="label">Configurations</div></div></label>
        </div>
      </section>

      <section class="group step" aria-hidden="true">
        <div class="q">
          <h2>7. Planning Info</h2>
          <div class="optional">Only used to send timely offers</div>
        </div>
        <div style="margin-top:10px">
          <div class="muted" style="font-size:13px;margin-bottom:8px">Next planned purchase:</div>
          <div class="row" role="group" aria-label="Next planned purchase">
            <label class="opt small"><input type="radio" name="purchase_when" value="Within 3 months" /><div><div class="label">Within 3 months</div></div></label>
            <label class="opt small"><input type="radio" name="purchase_when" value="3â€“6 months" /><div><div class="label">3â€“6 months</div></div></label>
            <label class="opt small"><input type="radio" name="purchase_when" value="6+ months" /><div><div class="label">6+ months</div></div></label>
            <label class="opt small"><input type="radio" name="purchase_when" value="Just browsing" /><div><div class="label">Just browsing</div></div></label>
          </div>
          <div class="muted" style="font-size:13px;margin:14px 0 8px 0">Typical budget range:</div>
          <div class="row" role="group" aria-label="Budget range">
            <label class="opt small"><input type="radio" name="budget" value="Under Â£5k" /><div><div class="label">Under Â£5k</div></div></label>
            <label class="opt small"><input type="radio" name="budget" value="Â£5kâ€“Â£20k" /><div><div class="label">Â£5kâ€“Â£20k</div></div></label>
            <label class="opt small"><input type="radio" name="budget" value="Â£20k+" /><div><div class="label">Â£20k+</div></div></label>
            <label class="opt small"><input type="radio" name="budget" value="Not sure" /><div><div class="label">Not sure</div></div></label>
          </div>
        </div>
      </section>

      <section class="group step" aria-hidden="true">
        <div class="q">
          <h2>Email address</h2>
          <div class="optional">Required</div>
        </div>
        <input type="email" name="EMAIL" id="email" required placeholder="name@company.com" style="width: 100%; box-sizing: border-box; padding: 10px; font-size: 16px; border-radius: 8px; border: 1px solid #ccc; margin-top: 10px;" />
      </section>

    </div>

    <div class="actions full-width">
      <button type="button" class="btn ghost" id="backBtn" style="display: none;">Back</button>
      <button type="button" class="btn" id="nextBtn">Next</button>
      <button type="submit" class="btn" id="submitBtn" style="display: none;">Save preferences</button>
    </div>

    <div class="thanks" id="thankYou" role="status" aria-live="polite">
      Thanks â€” your preferences have been recorded.
    </div>
  </form>
</div>

<script>
(function() {
  const form = document.getElementById('prefsForm');
  const card = form.closest('.card');
  const steps = Array.from(document.querySelectorAll('.step'));
  const backBtn = document.getElementById('backBtn');
  const nextBtn = document.getElementById('nextBtn');
  const submitBtn = document.getElementById('submitBtn');
  const thankYou = document.getElementById('thankYou');
  const progressBar = document.querySelector('.progress-fill');
  const allQuestionGroups = Array.from(document.querySelectorAll('.group'));
  
  let currentStep = 0;

  // Function to determine the card's height based on the tallest step
  function setCardHeight() {
    let maxHeight = 0;
    allQuestionGroups.forEach(step => {
      // Temporarily show and position the step to measure its height
      step.style.position = 'absolute';
      step.style.opacity = '0';
      step.style.transform = 'none';
      
      const height = step.offsetHeight;
      if (height > maxHeight) {
        maxHeight = height;
      }
      
      // Reset the styles
      step.style.position = '';
      step.style.opacity = '';
      step.style.transform = '';
    });

    card.style.setProperty('--form-height', `${maxHeight + 110}px`);
  }

  // Initial height setting and on window resize
  setCardHeight();
  window.addEventListener('resize', setCardHeight);

  // Updates the progress bar based on the current step
  function updateProgressBar() {
    const progress = (currentStep / (steps.length - 1)) * 100;
    progressBar.style.width = `${progress}%`;
  }
  
  // Controls the step navigation and display
  function showStep(stepIndex, direction) {
    if (stepIndex < 0 || stepIndex >= steps.length) return;

    const oldStep = steps[currentStep];
    const newStep = steps[stepIndex];

    // Reset classes on all steps
    steps.forEach(s => s.classList.remove('active', 'prev', 'next', 'fade-in', 'fade-out'));

    // Apply directional classes for animation
    if (direction === 'forward') {
      oldStep.classList.add('prev');
      newStep.classList.add('next');
    } else {
      oldStep.classList.add('next');
      newStep.classList.add('prev');
    }

    // Force a reflow to ensure the transition is triggered
    void newStep.offsetWidth;

    // Set the new active step
    newStep.classList.add('active', 'fade-in');
    
    currentStep = stepIndex;

    // Update button visibility
    backBtn.style.display = currentStep > 0 ? 'block' : 'none';
    nextBtn.style.display = currentStep < steps.length - 1 ? 'block' : 'none';
    submitBtn.style.display = currentStep === steps.length - 1 ? 'block' : 'none';

    updateProgressBar();
  }

  // Set initial step
  steps[0].classList.add('active');
  updateProgressBar();

  nextBtn.addEventListener('click', () => {
    // Basic validation for the first step
    if (currentStep === 0) {
      const serverOptions = document.querySelectorAll('input[name="servers"]');
      const isServerSelected = Array.from(serverOptions).some(input => input.checked);
      if (!isServerSelected) {
        alert('Please select at least one server type to continue.');
        return;
      }
    }
    showStep(currentStep + 1, 'forward');
  });

  backBtn.addEventListener('click', () => {
    showStep(currentStep - 1, 'back');
  });

  form.addEventListener('submit', function(ev) {
    // Prevent default submission if no Mailchimp action URL is present
    const action = (form.getAttribute('action') || '').trim();
    if (!action) {
      ev.preventDefault();
      console.log('Form is ready to submit. Please add your Mailchimp action URL.');
      thankYou.classList.add('show');
      thankYou.scrollIntoView({ behavior: 'smooth', block: 'center' });
      return false;
    }
    return true;
  });

  const allInputs = document.querySelectorAll('.opt input');
  allInputs.forEach(input => {
    const label = input.closest('label');

    // Toggle selected class on click/change
    input.addEventListener('change', () => {
      if (input.type === 'radio') {
        // Handle radio buttons to deselect others in the same group
        document.querySelectorAll(`input[name="${input.name}"]`).forEach(radio => {
          radio.closest('label').classList.remove('selected');
        });
        label.classList.add('selected');
      } else {
        label.classList.toggle('selected', input.checked);
      }
    });

    // Handle conditional panel logic for server types
    if (input.name === 'servers') {
      input.addEventListener('change', () => {
        const targetId = input.dataset.target;
        if (targetId) {
          const panel = document.querySelector(targetId);
          if (panel) {
            panel.classList.toggle('open', input.checked);
          }
        }
      });
    }
  });

})();
</script>
</body>
</html>
